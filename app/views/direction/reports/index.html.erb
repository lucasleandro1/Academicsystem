<% content_for :title, "Relatórios" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="fas fa-chart-bar"></i> Relatórios Gerais</h1>
  <div class="btn-group">
    <%= link_to direction_reports_path(format: :pdf), class: "btn btn-primary", target: "_blank" do %>
      <i class="fas fa-file-pdf"></i> Gerar PDF
    <% end %>
  </div>
</div>

<!-- Cards de Relatórios Específicos -->
<div class="row mb-4">
  <div class="col-md-3 mb-3">
    <%= link_to attendance_report_direction_reports_path, class: "text-decoration-none" do %>
      <div class="card text-center h-100 hover-shadow">
        <div class="card-body">
          <i class="fas fa-chart-line fa-2x text-primary mb-2"></i>
          <h6>Frequência de Alunos</h6>
          <small class="text-muted">Relatórios detalhados de presença</small>
        </div>
      </div>
    <% end %>
  </div>
  <div class="col-md-3 mb-3">
    <%= link_to grades_report_direction_reports_path, class: "text-decoration-none" do %>
      <div class="card text-center h-100 hover-shadow">
        <div class="card-body">
          <i class="fas fa-chart-bar fa-2x text-success mb-2"></i>
          <h6>Relatório de Notas</h6>
          <small class="text-muted">Desempenho por turma/disciplina</small>
        </div>
      </div>
    <% end %>
  </div>
  <div class="col-md-3 mb-3">
    <%= link_to student_bulletin_direction_reports_path, class: "text-decoration-none" do %>
      <div class="card text-center h-100 hover-shadow">
        <div class="card-body">
          <i class="fas fa-user-graduate fa-2x text-info mb-2"></i>
          <h6>Boletim por Aluno</h6>
          <small class="text-muted">Boletim individual detalhado</small>
        </div>
      </div>
    <% end %>
  </div>
  <div class="col-md-3 mb-3">
    <%= link_to performance_stats_direction_reports_path, class: "text-decoration-none" do %>
      <div class="card text-center h-100 hover-shadow">
        <div class="card-body">
          <i class="fas fa-chart-pie fa-2x text-warning mb-2"></i>
          <h6>Estatísticas de Desempenho</h6>
          <small class="text-muted">Análises comparativas</small>
        </div>
      </div>
    <% end %>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-6 mb-3">
    <%= link_to direction_messages_path, class: "text-decoration-none" do %>
      <div class="card text-center h-100 hover-shadow">
        <div class="card-body">
          <i class="fas fa-envelope fa-2x text-secondary mb-2"></i>
          <h6>Mensagens Internas</h6>
          <small class="text-muted">Sistema de comunicação</small>
        </div>
      </div>
    <% end %>
  </div>
</div>

<div class="row">
  <!-- Relatório de Alunos -->
  <div class="col-lg-6 mb-4">
    <div class="card">
      <div class="card-header">
        <h5><i class="fas fa-user-graduate"></i> Relatório de Alunos</h5>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-6">
            <h3 class="text-primary"><%= @students_report[:total] %></h3>
            <small class="text-muted">Total de Alunos</small>
          </div>
          <div class="col-6">
            <h3 class="text-success"><%= @students_report[:active] %></h3>
            <small class="text-muted">Alunos Ativos</small>
          </div>
        </div>
        
        <hr>
        
        <h6>Alunos por Turma:</h6>
        <% @students_report[:by_classroom].each do |classroom, count| %>
          <div class="d-flex justify-content-between">
            <span><%= classroom %></span>
            <span class="badge bg-primary"><%= count %></span>
          </div>
        <% end %>
        
        <div class="mt-3">
          <h6>Matrículas Pendentes:</h6>
          <span class="badge bg-warning"><%= @students_report[:pending] %></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Relatório de Professores -->
  <div class="col-lg-6 mb-4">
    <div class="card">
      <div class="card-header">
        <h5><i class="fas fa-chalkboard-teacher"></i> Relatório de Professores</h5>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-6">
            <h3 class="text-info"><%= @teachers_report[:total] %></h3>
            <small class="text-muted">Total de Professores</small>
          </div>
        </div>
        
        <hr>
        
        <h6>Disciplinas por Professor:</h6>
        <% @teachers_report[:subjects_assigned].each do |teacher_name, count| %>
          <div class="d-flex justify-content-between small">
            <span><%= teacher_name %></span>
            <span class="badge bg-info"><%= count %></span>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <!-- Relatório Acadêmico -->
  <div class="col-lg-6 mb-4">
    <div class="card">
      <div class="card-header">
        <h5><i class="fas fa-graduation-cap"></i> Relatório Acadêmico</h5>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-6 mb-3">
            <h3 class="text-success"><%= @academic_report[:attendance_rate] %>%</h3>
            <small class="text-muted">Taxa de Frequência</small>
          </div>
          <div class="col-6 mb-3">
            <h3 class="text-primary"><%= @academic_report[:average_grades] %></h3>
            <small class="text-muted">Média Geral</small>
          </div>
          <div class="col-6">
            <h3 class="text-info"><%= @academic_report[:total_activities] %></h3>
            <small class="text-muted">Total de Atividades</small>
          </div>
          <div class="col-6">
            <h3 class="text-warning"><%= @academic_report[:completed_activities] %></h3>
            <small class="text-muted">Atividades Concluídas</small>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Ações -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5><i class="fas fa-tools"></i> Ações Disponíveis</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-3 mb-2">
            <%= link_to direction_students_path, class: "btn btn-outline-primary w-100" do %>
              <i class="fas fa-user-graduate"></i><br>
              <small>Gerenciar Alunos</small>
            <% end %>
          </div>
          <div class="col-md-3 mb-2">
            <%= link_to direction_teachers_path, class: "btn btn-outline-success w-100" do %>
              <i class="fas fa-chalkboard-teacher"></i><br>
              <small>Gerenciar Professores</small>
            <% end %>
          </div>
          <div class="col-md-3 mb-2">
            <%= link_to direction_classrooms_path, class: "btn btn-outline-info w-100" do %>
              <i class="fas fa-users"></i><br>
              <small>Gerenciar Turmas</small>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
