<% content_for :title, "Nova Matrícula" %>

<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1 class="h3 mb-0 text-gray-800">
            <i class="fas fa-user-plus text-primary me-2"></i>
            Nova Matrícula
          </h1>
          <p class="text-muted">Matricular novo estudante na escola</p>
        </div>
        <%= link_to direction_enrollments_path, class: "btn btn-secondary" do %>
          <i class="fas fa-arrow-left me-2"></i>Voltar
        <% end %>
      </div>

      <!-- Formulário de Nova Matrícula -->
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">
            <i class="fas fa-user-plus me-2"></i>Dados da Matrícula
          </h5>
        </div>
        <div class="card-body">
          <%= form_with model: [@enrollment], url: direction_enrollments_path, local: true do |form| %>
            <div class="row">
              <!-- Dados do Estudante -->
              <div class="col-md-6">
                <h6 class="text-primary mb-3">
                  <i class="fas fa-user me-2"></i>Dados do Estudante
                </h6>
                
                <div class="mb-3">
                  <%= form.label :student_name, "Nome Completo", class: "form-label" %>
                  <%= form.text_field :student_name, 
                      class: "form-control", 
                      placeholder: "Digite o nome completo do estudante",
                      required: true %>
                </div>

                <div class="mb-3">
                  <%= form.label :student_email, "Email", class: "form-label" %>
                  <%= form.email_field :student_email, 
                      class: "form-control", 
                      placeholder: "estudante@exemplo.com",
                      required: true %>
                </div>

                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <%= form.label :student_cpf, "CPF", class: "form-label" %>
                      <%= form.text_field :student_cpf, 
                          class: "form-control", 
                          placeholder: "000.000.000-00",
                          required: true %>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <%= form.label :student_phone, "Telefone", class: "form-label" %>
                      <%= form.text_field :student_phone, 
                          class: "form-control", 
                          placeholder: "(00) 00000-0000" %>
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <%= form.label :student_birth_date, "Data de Nascimento", class: "form-label" %>
                  <%= form.date_field :student_birth_date, 
                      class: "form-control",
                      required: true %>
                </div>
              </div>

              <!-- Dados da Matrícula -->
              <div class="col-md-6">
                <h6 class="text-primary mb-3">
                  <i class="fas fa-school me-2"></i>Dados da Matrícula
                </h6>

                <div class="mb-3">
                  <%= form.label :classroom_id, "Turma", class: "form-label" %>
                  <%= form.select :classroom_id, 
                      options_from_collection_for_select(@school.classrooms.order(:name), :id, :name),
                      { prompt: "Selecione uma turma" },
                      { class: "form-select", required: true } %>
                </div>

                <div class="mb-3">
                  <%= form.label :enrollment_date, "Data da Matrícula", class: "form-label" %>
                  <%= form.date_field :enrollment_date, 
                      class: "form-control",
                      value: Date.current,
                      required: true %>
                </div>

                <div class="mb-3">
                  <%= form.label :status, "Status", class: "form-label" %>
                  <%= form.select :status, [
                        ['Pendente', 'pending'],
                        ['Aprovada', 'approved'],
                        ['Ativa', 'active']
                      ], 
                      { selected: 'pending' },
                      { class: "form-select" } %>
                </div>

                <div class="mb-3">
                  <%= form.label :student_address, "Endereço", class: "form-label" %>
                  <%= form.text_area :student_address, 
                      class: "form-control", 
                      rows: 3,
                      placeholder: "Endereço completo do estudante" %>
                </div>
              </div>
            </div>

            <!-- Responsável (Opcional) -->
            <hr class="my-4">
            <h6 class="text-primary mb-3">
              <i class="fas fa-user-friends me-2"></i>Dados do Responsável (Opcional)
            </h6>
            
            <div class="row">
              <div class="col-md-4">
                <div class="mb-3">
                  <%= form.label :guardian_name, "Nome do Responsável", class: "form-label" %>
                  <%= form.text_field :guardian_name, 
                      class: "form-control", 
                      placeholder: "Nome completo do responsável" %>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <%= form.label :guardian_phone, "Telefone do Responsável", class: "form-label" %>
                  <%= form.text_field :guardian_phone, 
                      class: "form-control", 
                      placeholder: "(00) 00000-0000" %>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3">
                  <%= form.label :guardian_email, "Email do Responsável", class: "form-label" %>
                  <%= form.email_field :guardian_email, 
                      class: "form-control", 
                      placeholder: "responsavel@exemplo.com" %>
                </div>
              </div>
            </div>

            <!-- Observações -->
            <div class="mb-3">
              <%= form.label :notes, "Observações", class: "form-label" %>
              <%= form.text_area :notes, 
                  class: "form-control", 
                  rows: 3,
                  placeholder: "Observações sobre a matrícula (opcional)" %>
            </div>

            <!-- Botões de Ação -->
            <div class="d-flex justify-content-between">
              <%= link_to direction_enrollments_path, class: "btn btn-secondary" do %>
                <i class="fas fa-times me-2"></i>Cancelar
              <% end %>
              
              <%= form.submit "Criar Matrícula", class: "btn btn-primary" do %>
                <i class="fas fa-save me-2"></i>Criar Matrícula
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <!-- Cards Informativos -->
      <div class="row mt-4">
        <div class="col-md-4">
          <div class="card bg-info text-white">
            <div class="card-body text-center">
              <i class="fas fa-info-circle fa-2x mb-2"></i>
              <h6>Matrícula Pendente</h6>
              <p class="small mb-0">A matrícula será criada com status pendente por padrão</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card bg-success text-white">
            <div class="card-body text-center">
              <i class="fas fa-user-check fa-2x mb-2"></i>
              <h6>Criação de Usuário</h6>
              <p class="small mb-0">Um usuário estudante será criado automaticamente</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card bg-warning text-white">
            <div class="card-body text-center">
              <i class="fas fa-envelope fa-2x mb-2"></i>
              <h6>Notificação</h6>
              <p class="small mb-0">O estudante receberá email com dados de acesso</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.card {
  transition: all 0.3s ease;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
}

.form-label {
  font-weight: 600;
  color: #495057;
}

.form-control:focus, .form-select:focus {
  border-color: #4e73df;
  box-shadow: 0 0 0 0.2rem rgba(78, 115, 223, 0.25);
}

.btn-primary {
  background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);
  border: none;
}

.btn-primary:hover {
  background: linear-gradient(135deg, #224abe 0%, #1e3a8a 100%);
  transform: translateY(-1px);
}

.bg-info {
  background: linear-gradient(135deg, #36b9cc 0%, #2c9faf 100%) !important;
}

.bg-success {
  background: linear-gradient(135deg, #1cc88a 0%, #17a673 100%) !important;
}

.bg-warning {
  background: linear-gradient(135deg, #f6c23e 0%, #dda20a 100%) !important;
}
</style>
